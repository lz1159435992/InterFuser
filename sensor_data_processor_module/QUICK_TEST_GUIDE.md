# å¿«é€Ÿæµ‹è¯•æŒ‡å—

## ğŸ“‹ ç›®çš„

å¿«é€ŸéªŒè¯å¸¦æ•°æ®å¤„ç†å™¨çš„ InterFuser Agent æ˜¯å¦èƒ½æ­£å¸¸å·¥ä½œã€‚
åªæµ‹è¯• **3 æ¡çŸ­è·¯çº¿**ï¼Œé¢„è®¡ **5-15 åˆ†é’Ÿ**å®Œæˆã€‚

---

## ğŸš€ ä½¿ç”¨æ–¹æ³•

### æ–¹æ³• 1ï¼šä¸€é”®æµ‹è¯•ï¼ˆæ¨èï¼‰â­

```bash
# åœ¨ç»ˆç«¯ 1 ä¸­å¯åŠ¨ CARLA
cd /home/nju/InterFuser/evaluation_scripts
./start_carla_server.sh

# åœ¨ç»ˆç«¯ 2 ä¸­è¿è¡Œå¿«é€Ÿæµ‹è¯•
cd /home/nju/InterFuser/sensor_data_processor_module
chmod +x quick_test.sh
./quick_test.sh fast
```

### æ–¹æ³• 2ï¼šæŒ‡å®šæµ‹è¯•æ¨¡å¼

```bash
# å¿«é€Ÿæ¨¡å¼ï¼ˆä¼˜åŒ–æ€§èƒ½ï¼Œè½»åº¦å™ªå£°ï¼‰
./quick_test.sh fast

# ä¸­åº¦å™ªå£°æ¨¡å¼
./quick_test.sh moderate

# è°ƒè¯•æ¨¡å¼ï¼ˆä¿å­˜å¤„ç†åçš„å›¾åƒï¼‰
./quick_test.sh debug
```

### æ–¹æ³• 3ï¼šæŒ‡å®š GPU

```bash
# ä½¿ç”¨ GPU 1
GPU_ID=1 ./quick_test.sh fast
```

---

## ğŸ“Š æµ‹è¯•æ¨¡å¼å¯¹æ¯”

| æ¨¡å¼ | å™ªå£°çº§åˆ« | ä¿å­˜å›¾åƒ | æ—¥å¿—çº§åˆ« | é¢„è®¡æ—¶é—´ | æ¨èåœºæ™¯ |
|------|---------|---------|---------|---------|---------|
| **fast** | è½»åº¦ | âŒ | INFO | 5-8 åˆ†é’Ÿ | âœ… å¿«é€ŸéªŒè¯åŠŸèƒ½ |
| **moderate** | ä¸­åº¦ | âŒ | INFO | 8-12 åˆ†é’Ÿ | éªŒè¯é²æ£’æ€§ |
| **debug** | ä¸­åº¦ | âœ… | DEBUG | 12-15 åˆ†é’Ÿ | è°ƒè¯•å’Œåˆ†æ |

---

## ğŸ“ æµ‹è¯•å†…å®¹

### æµ‹è¯•è·¯çº¿

**æ–‡ä»¶**: `test_routes_short.xml`

åŒ…å« **3 æ¡çŸ­è·¯çº¿**ï¼Œéƒ½åœ¨ Town05:

1. **è·¯çº¿ 0**: 3 ä¸ªèˆªç‚¹
2. **è·¯çº¿ 1**: 3 ä¸ªèˆªç‚¹
3. **è·¯çº¿ 2**: 3 ä¸ªèˆªç‚¹

**æ€»å…±çº¦**: 300-600 ç±³çš„è¡Œé©¶è·ç¦»

### é¢„æœŸç»“æœ

âœ… **æˆåŠŸæ ‡å‡†**:
- 3 æ¡è·¯çº¿éƒ½èƒ½å¯åŠ¨
- Agent èƒ½æ­£å¸¸å¤„ç†ä¼ æ„Ÿå™¨æ•°æ®
- æ²¡æœ‰å´©æºƒæˆ– timeout
- ç”Ÿæˆç»“æœ JSON æ–‡ä»¶

âš ï¸ **å¯æ¥å—**:
- ä¸ªåˆ«è·¯çº¿æœªå®Œæˆï¼ˆç¢°æ’ã€è¶…æ—¶ç­‰ï¼‰
- åˆ†æ•°ä¸é«˜ï¼ˆè¿™æ˜¯æµ‹è¯•ï¼Œä¸æ˜¯è¯„ä¼°ï¼‰

âŒ **å¤±è´¥æ ‡å‡†**:
- Python å¯¼å…¥é”™è¯¯
- Agent æ— æ³•å¯åŠ¨
- é¢‘ç¹å´©æºƒ

---

## ğŸ” æµ‹è¯•æµç¨‹

è„šæœ¬ä¼šè‡ªåŠ¨æ‰§è¡Œä»¥ä¸‹æ­¥éª¤ï¼š

```
1. ğŸ“¦ å¤‡ä»½åŸå§‹æ–‡ä»¶
   â””â”€ ä¿å­˜åˆ° .backup_test_YYYYMMDD_HHMMSS/

2. ğŸ“¥ éƒ¨ç½²æ•°æ®å¤„ç†å™¨
   â”œâ”€ å¤åˆ¶ data_processor.py
   â”œâ”€ å¤åˆ¶ data_processor_config.py
   â””â”€ éƒ¨ç½² interfuser_agent_complete.py

3. âš™ï¸  è®¾ç½®ç¯å¢ƒ
   â”œâ”€ æ¿€æ´» conda ç¯å¢ƒ
   â”œâ”€ è®¾ç½® CARLA è·¯å¾„
   â””â”€ é…ç½®æµ‹è¯•å‚æ•°

4. ğŸ” æ£€æŸ¥ CARLA æœåŠ¡å™¨
   â””â”€ éªŒè¯ç«¯å£ 2000 è¿æ¥

5. ğŸ§ª è¿è¡Œæµ‹è¯•ï¼ˆ3 æ¡è·¯çº¿ï¼‰
   â””â”€ è°ƒç”¨ leaderboard_evaluator.py

6. ğŸ“Š æ˜¾ç¤ºç»“æœ
   â”œâ”€ è§£æ JSON ç»“æœ
   â”œâ”€ æ˜¾ç¤ºæˆåŠŸç‡
   â””â”€ æ˜¾ç¤ºæ¯æ¡è·¯çº¿çŠ¶æ€

7. ğŸ”„ è¯¢é—®æ˜¯å¦æ¢å¤
   â””â”€ å¯é€‰æ‹©æ¢å¤åŸå§‹æ–‡ä»¶
```

---

## ğŸ“ˆ å®æ—¶ç›‘æ§

### æµ‹è¯•è¿‡ç¨‹ä¸­ä¼šæ˜¾ç¤º

```
ğŸ§ª æ­¥éª¤ 5/6: è¿è¡Œå¿«é€Ÿæµ‹è¯•

æµ‹è¯•é…ç½®:
  â€¢ GPU: 0
  â€¢ è·¯çº¿æ•°: 3 æ¡
  â€¢ æµ‹è¯•æ¨¡å¼: fast
  â€¢ åœºæ™¯: Town05

å¼€å§‹æµ‹è¯•...
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

[CARLA æ—¥å¿—è¾“å‡º]
...
```

### æˆåŠŸçš„æ ‡å¿—

- âœ… çœ‹åˆ° "Loading route X" (X = 0, 1, 2)
- âœ… çœ‹åˆ°æ•°æ®å¤„ç†å™¨æ—¥å¿—ï¼ˆå¦‚æœ log_level æ˜¯ INFOï¼‰
- âœ… çœ‹åˆ°æ§åˆ¶è¾“å‡ºï¼ˆthrottle, steer, brakeï¼‰
- âœ… æ²¡æœ‰ Python é”™è¯¯

### é—®é¢˜çš„æ ‡å¿—

- âŒ ImportError / ModuleNotFoundError
- âŒ é¢‘ç¹çš„ "TIMEOUT" è­¦å‘Š
- âŒ Python å¼‚å¸¸å †æ ˆ
- âŒ CARLA æ–­å¼€è¿æ¥

---

## ğŸ“Š ç»“æœåˆ†æ

### è‡ªåŠ¨åˆ†æ

æµ‹è¯•å®Œæˆåä¼šè‡ªåŠ¨æ˜¾ç¤ºï¼š

```
ğŸ“Š æ­¥éª¤ 6/6: æµ‹è¯•ç»“æœ

ğŸ” å¿«é€Ÿåˆ†æ:
  âœ“ æ€»è·¯çº¿æ•°: 3
  âœ“ å®Œæˆæ•°: 3
  âœ“ æˆåŠŸç‡: 100.0%
  âœ“ å¹³å‡åˆ†æ•°: 85.50

  è¯¦ç»†è·¯çº¿ç»“æœ:
    âœ… è·¯çº¿ 0: Completed (åˆ†æ•°: 90.00)
    âœ… è·¯çº¿ 1: Completed (åˆ†æ•°: 85.00)
    âœ… è·¯çº¿ 2: Completed (åˆ†æ•°: 81.50)
```

### æ‰‹åŠ¨åˆ†æ

```bash
# ä½¿ç”¨åˆ†æè„šæœ¬
python3 analyze_results.py results/test/quick_test_fast_*.json

# æŸ¥çœ‹ JSON æ–‡ä»¶
cat results/test/quick_test_fast_20250107_120000.json
```

---

## ğŸ—‚ï¸ ç»“æœæ–‡ä»¶

æµ‹è¯•å®Œæˆåä¼šç”Ÿæˆï¼š

```
/home/nju/InterFuser/
â”œâ”€â”€ results/test/
â”‚   â””â”€â”€ quick_test_fast_20250107_120000.json    # JSON ç»“æœ
â”‚
â”œâ”€â”€ data/test/
â”‚   â””â”€â”€ quick_test_fast_20250107_120000/
â”‚       â”œâ”€â”€ test_metadata.json                  # æµ‹è¯•å…ƒæ•°æ®
â”‚       â””â”€â”€ meta/                                # å¯è§†åŒ–å›¾åƒ
â”‚           â”œâ”€â”€ 0000.jpg
â”‚           â”œâ”€â”€ 0001.jpg
â”‚           â””â”€â”€ ...
â”‚
â””â”€â”€ sensor_data_processor_module/
    â””â”€â”€ .backup_test_20250107_120000/           # å¤‡ä»½æ–‡ä»¶
        â”œâ”€â”€ interfuser_agent.py.bak
        â”œâ”€â”€ data_processor.py.bak
        â””â”€â”€ data_processor_config.py.bak
```

---

## ğŸ”§ æ•…éšœæ’æŸ¥

### é—®é¢˜ 1: CARLA æœåŠ¡å™¨æœªè¿è¡Œ

**é”™è¯¯ä¿¡æ¯**:
```
âœ— è­¦å‘Š: æ— æ³•è¿æ¥åˆ° CARLA æœåŠ¡å™¨ (ç«¯å£ 2000)
```

**è§£å†³æ–¹æ³•**:
```bash
# åœ¨å¦ä¸€ä¸ªç»ˆç«¯è¿è¡Œ
cd /home/nju/InterFuser/evaluation_scripts
./start_carla_server.sh
```

### é—®é¢˜ 2: å¯¼å…¥é”™è¯¯

**é”™è¯¯ä¿¡æ¯**:
```
ModuleNotFoundError: No module named 'data_processor'
```

**è§£å†³æ–¹æ³•**:
```bash
# ç¡®è®¤æ–‡ä»¶å·²å¤åˆ¶
ls -l /home/nju/InterFuser/leaderboard/team_code/data_processor*.py

# é‡æ–°è¿è¡Œæµ‹è¯•
./quick_test.sh fast
```

### é—®é¢˜ 3: Timeout é¢‘ç¹

**å¯èƒ½åŸå› **:
- æ•°æ®å¤„ç†å™¨é…ç½®å¤ªé‡ï¼ˆä¾‹å¦‚ï¼šdebug æ¨¡å¼ï¼‰
- GPU æ€§èƒ½ä¸è¶³
- CARLA æœåŠ¡å™¨è´Ÿè½½é«˜

**è§£å†³æ–¹æ³•**:
```bash
# ä½¿ç”¨ fast æ¨¡å¼
./quick_test.sh fast

# æˆ–é™ä½å™ªå£°çº§åˆ«
# ç¼–è¾‘ data_processor_config.pyï¼Œä½¿ç”¨æ›´è½»çš„é…ç½®
```

### é—®é¢˜ 4: æ€§èƒ½å¤ªæ…¢

**ç—‡çŠ¶**: å¸§ç‡ < 10 FPS

**è§£å†³æ–¹æ³•**:
```bash
# 1. æ£€æŸ¥æ˜¯å¦å…³é—­äº†å›¾åƒä¿å­˜
grep "save_processed_images" leaderboard/team_code/data_processor_config.py
# åº”è¯¥çœ‹åˆ°: "save_processed_images": False

# 2. ä½¿ç”¨ fast æ¨¡å¼
./quick_test.sh fast

# 3. æŸ¥çœ‹æ€§èƒ½æŒ‡å—
cat SYNC_AND_PERFORMANCE_GUIDE.md
```

---

## âœ… éªŒè¯æ¸…å•

æµ‹è¯•å‰ï¼š
- [ ] CARLA æœåŠ¡å™¨å·²å¯åŠ¨
- [ ] conda ç¯å¢ƒå·²æ¿€æ´»
- [ ] æœ‰è¶³å¤Ÿçš„ GPU å†…å­˜ï¼ˆå»ºè®® > 4GBï¼‰

æµ‹è¯•ä¸­ï¼š
- [ ] æ²¡æœ‰ Python é”™è¯¯
- [ ] èƒ½çœ‹åˆ°è·¯çº¿åŠ è½½ä¿¡æ¯
- [ ] æ²¡æœ‰é¢‘ç¹ timeout

æµ‹è¯•åï¼š
- [ ] ç”Ÿæˆäº† JSON ç»“æœæ–‡ä»¶
- [ ] è‡³å°‘ 1 æ¡è·¯çº¿å®Œæˆ
- [ ] æ•°æ®å¤„ç†å™¨ç»Ÿè®¡ä¿¡æ¯æ­£å¸¸

---

## ğŸ¯ ä¸‹ä¸€æ­¥

### å¦‚æœæµ‹è¯•æˆåŠŸ âœ…

**æ­å–œï¼æ•°æ®å¤„ç†å™¨å·¥ä½œæ­£å¸¸ã€‚**

ä¸‹ä¸€æ­¥å¯ä»¥ï¼š

1. **è¿è¡Œå®Œæ•´è¯„ä¼°**:
   ```bash
   ./run_evaluation_with_processor.sh town05 mild
   ```

2. **å°è¯•ä¸åŒé…ç½®**:
   ```bash
   ./quick_test.sh moderate
   ./quick_test.sh debug
   ```

3. **åˆ†ææ€§èƒ½**:
   ```bash
   # å¯ç”¨æ€§èƒ½ç›‘æ§
   # ç¼–è¾‘ interfuser_agent_complete.py:
   #   self.enable_performance_monitoring = True
   
   ./quick_test.sh fast
   # æŸ¥çœ‹æ€§èƒ½æŠ¥å‘Š
   ```

### å¦‚æœæµ‹è¯•å¤±è´¥ âŒ

**ä¸è¦æ…Œï¼æŒ‰ä»¥ä¸‹æ­¥éª¤æ’æŸ¥ï¼š**

1. **æŸ¥çœ‹é”™è¯¯æ—¥å¿—**:
   ```bash
   # æŸ¥çœ‹è¯¦ç»†è¾“å‡º
   ./quick_test.sh fast 2>&1 | tee test.log
   ```

2. **æ£€æŸ¥æ–‡ä»¶**:
   ```bash
   # ç¡®è®¤æ–‡ä»¶å·²éƒ¨ç½²
   ls -l leaderboard/team_code/data_processor*.py
   ls -l leaderboard/team_code/interfuser_agent.py
   ```

3. **æ‰‹åŠ¨æµ‹è¯•å¯¼å…¥**:
   ```bash
   cd /home/nju/InterFuser
   conda activate interfuser
   python3 -c "from leaderboard.team_code.data_processor import SensorDataProcessor; print('OK')"
   ```

4. **æ¢å¤åŸå§‹æ–‡ä»¶**:
   ```bash
   ./restore_original_agent.sh
   ```

5. **æŸ¥çœ‹æ–‡æ¡£**:
   ```bash
   cat DATA_PROCESSOR_USAGE_GUIDE.md
   cat SYNC_AND_PERFORMANCE_GUIDE.md
   ```

---

## ğŸ’¡ æç¤º

1. **é¦–æ¬¡æµ‹è¯•å»ºè®®ä½¿ç”¨ `fast` æ¨¡å¼** - æœ€å¿«ï¼Œæœ€ç¨³å®š
2. **è°ƒè¯•æ—¶ä½¿ç”¨ `debug` æ¨¡å¼** - ä¿å­˜å›¾åƒï¼Œè¯¦ç»†æ—¥å¿—
3. **æµ‹è¯•åè®°å¾—æ¢å¤** - é¿å…å½±å“å…¶ä»–è¯„ä¼°
4. **æŸ¥çœ‹ç”Ÿæˆçš„å›¾åƒ** - éªŒè¯æ•°æ®å¤„ç†æ•ˆæœ
5. **ç›‘æ§ GPU ä½¿ç”¨** - ç¡®ä¿æ²¡æœ‰å†…å­˜æ³„æ¼

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- `EVALUATION_GUIDE.md` - å®Œæ•´è¯„ä¼°æŒ‡å—
- `QUICK_REFERENCE.md` - å¿«é€Ÿå‚è€ƒ
- `SYNC_AND_PERFORMANCE_GUIDE.md` - æ€§èƒ½ä¼˜åŒ–
- `DATA_PROCESSOR_USAGE_GUIDE.md` - æ•°æ®å¤„ç†å™¨ä½¿ç”¨

---

**ç¥æµ‹è¯•é¡ºåˆ©ï¼** ğŸ§ªâœ¨

